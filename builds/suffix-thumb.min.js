!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((r="undefined"!=typeof globalThis?globalThis:r||self).suffixThumb={})}(this,(function(r){"use strict";var n=/^.([0-9]+)/,e=function(r,n){if(e=n.rules,"[object Array]"===Object.prototype.toString.call(e))return n.rules;var e,t=r[r.length-1],o=n.rules[t]||[];return 0===o.length&&(o=n.rules[""]||o),o};function t(r,n){return function(r){if(Array.isArray(r))return r}(r)||function(r,n){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null==e)return;var t,o,u=[],i=!0,f=!1;try{for(e=e.call(r);!(i=(t=e.next()).done)&&(u.push(t.value),!n||u.length!==n);i=!0);}catch(r){f=!0,o=r}finally{try{i||null==e.return||e.return()}finally{if(f)throw o}}return u}(r,n)||function(r,n){if(!r)return;if("string"==typeof r)return o(r,n);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(r);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return o(r,n)}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(r,n){(null==n||n>r.length)&&(n=r.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=r[e];return t}var u=function(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=[],e=4;e>=0;e-=1)if(!(r.length-1<=e)){var t=r.substr(r.length-e-1,r.length-1);n.push(t)}return n},i=function(r){var n=[];return Object.keys(r).forEach((function(e){var t,o,u=(t=r[e],o=e,Object.keys(t).map((function(r){return{from:o,to:r,yes:t[r]}})).sort((function(r,n){return r.yes>n.yes?-1:r.yes<n.yes?1:0})));u[0]&&u[0].yes>1&&n.push(u[0])})),n=n.sort((function(r,n){return r.yes>n.yes?-1:r.yes<n.yes?1:0}))},f=function(r,n){var e=function(r,n){return r.map((function(r){var e=0,t=0,o={};return n.forEach((function(n){if(n[0].endsWith(r.from)){var u=new RegExp(r.from+"$");n[0].replace(u,r.to)===n[1]?e+=1:(t+=1,o[n[0]]=n[1])}})),{from:r.from,to:r.to,yes:e,no:t,percent:e/(e+t),exceptions:o}}))}(r,n);return e=(e=e.filter((function(r){return r.yes>1&&r.yes>r.no}))).sort((function(r,n){return r.yes>n.yes?-1:r.yes<n.yes?1:0}))};function c(r){return r.split("").reverse().join("")}var s=function(r){return(r=r.sort((function(r,n){return r.from.length>n.from.length?-1:r.from.length<n.from.length||(r=c(r.from))>(n=c(n.from))?1:r<n?-1:0}))).map((function(r){return[r.from,r.to,r.yes]}))},l=function(r){var n,e,t,o;return r.rules=(n=r.rules,e={},n.forEach((function(r){var n=r[0]||"",t=n[n.length-1]||"";e[t]=e[t]||[],e[t].push(r)})),e),r.exceptions=(t=r.exceptions,o={},Object.keys(t).forEach((function(r){var n=t[r],e=function(r,n){for(var e=[],t=0;t<r.length&&r[t]===n[t];t+=1)e.push(r[t]);return e.join("")}(r,n);if(e.length<2)o[r]=n;else{var u="."+e.length+n.substr(e.length);o[r]=u}})),o),r},a=function(r){var n,e,o=function(r){var n={};return r.forEach((function(r){var e=t(r,2),o=e[0],i=e[1],f=u(o);f.push(""),f.forEach((function(r){n[r]=n[r]||{},u(i).forEach((function(e){n[r][e]=n[r][e]||0,n[r][e]+=1}))}))})),n}(r=r.filter((function(r){return r&&r[0]&&r[1]}))),c=i(o),l=f(c,r);return e={},(n=l).forEach((function(r,t){n.slice(t+1,n.length).forEach((function(n){n.from.endsWith(r.from)&&(e[n.from]=!0)}))})),function(r,n){var e={};r.forEach((function(r){Object.assign(e,r.exceptions)}));var t=n.filter((function(n){return!e.hasOwnProperty(n[0])&&!r.find((function(r){return n[0].endsWith(r.from)}))})),o=(n.length-t.length)/n.length;return{rules:s(r),exceptions:e,coverage:o,remaining:t}}(l=n=n.filter((function(r){return!1===e.hasOwnProperty(r.from)})),r)},h=function(r,n){var e,t=0;return r.rules=r.rules.map((function(r){return t+=r[2],r.slice(0,2)})),r.exceptions=r.exceptions.reduce((function(r,n){return r[n[0]]=n[1],r}),{}),r.rules=r.rules.sort((function(r,n){return r[0].length>n[0].length?-1:r[0].length<n[0].length?1:0})),r.coverage=(e=t/n,Math.round(1e3*e)/1e3),r};r.compress=l,r.convert=function(r,t){if(t.exceptions.hasOwnProperty(r))return function(r,e){var t=e.exceptions[r],o=t.match(n);if(null===o)return e.exceptions[r];var u=Number(o[1])||0;return r.substr(0,u)+t.replace(n,"")}(r,t);for(var o=e(r,t),u=0;u<o.length;u+=1){var i=o[u][0];if(r.endsWith(i)){var f=new RegExp(i+"$");return r.replace(f,o[u][1])}}return null},r.find=function(r){var n=r.length,e={},t=a(r);return e.rules=t.rules||[],e.exceptions=t.remaining.concat(Object.entries(t.exceptions)),e=h(e,n),e=l(e)},Object.defineProperty(r,"__esModule",{value:!0})}));
